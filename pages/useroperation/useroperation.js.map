{"version":3,"sources":["pages/useroperation/useroperation.js"],"names":["app","getApp","useUrl","require","WxParse","Page","data","title","operation","numberList","message","integral","img","integralid","name","delMoney","useMoney","needIntegral","currentCouponTab","couponNumber","orderNumber","orderList","shopArray","index","showMessage","shopNameInput","e","setData","shopName","detail","value","chooseMessage","currentTarget","dataset","chooseCouponTab","tabid","goPay","wx","navigateTo","url","id","shop","goGratuity","sid","restaurantid","oid","chooseShopKind","startShop","showModal","content","showCancel","newShopInfo","shopKind","setStorageSync","redirectTo","getOrder","that","obj","serviceUrl","order","session_key","getStorageSync","success","res","order_suoyou","pay","order_weifu","finish","cancel","item","status","push","requestInfo","getWaitInfo","getCoupons","coupons_num","couponsCount","count","couponNoUseList","status_a","couponUseList","status_b","couponOutList","status_c","getMation","mation","messageArr","console","log","i","length","wxParse","wxParseTemArray","goshop","getpaidui","userSite","queue_num","latitude","longitude","getAllCoupons","getCouDetail","getCoupon","cou_convert","shop_id","cou_id","onLoad","params","shopStatus","setNavigationBarTitle","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":"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","file":"useroperation.js","sourcesContent":["// 获取全局应用程序实例对象\r\nconst app = getApp()\r\nconst useUrl = require('../../utils/service')\r\nconst WxParse = require('../../utils/wxParse/wxParse')\r\n// 创建页面实例对象\r\nPage({\r\n  /**\r\n   * 页面的初始数据\r\n   */\r\n  data: {\r\n    title: 'useroperation',\r\n    operation: null,\r\n    numberList: [],\r\n    message: [],\r\n    integral: [\r\n      {\r\n        img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\r\n        integralid: 'renma1',\r\n        name: '人马大饭堂',\r\n        delMoney: 20,\r\n        useMoney: 100,\r\n        needIntegral: 200\r\n      },\r\n      {\r\n        img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\r\n        integralid: 'renma2',\r\n        name: '人马大饭堂',\r\n        delMoney: 20,\r\n        useMoney: 100,\r\n        needIntegral: 200\r\n      },\r\n      {\r\n        img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\r\n        name: '人马大饭堂',\r\n        integralid: 'renma3',\r\n        delMoney: 20,\r\n        useMoney: 100,\r\n        needIntegral: 200\r\n      }\r\n    ],\r\n    currentCouponTab: 0,\r\n    couponNumber: [\r\n      {\r\n        title: '未使用'\r\n      },\r\n      {\r\n        title: '使用记录'\r\n      },\r\n      {\r\n        title: '已过期'\r\n      }\r\n    ],\r\n    orderNumber: ['待支付', '全部'],\r\n    orderList: {\r\n      // pay: [\r\n      //   {\r\n      //     img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\r\n      //     name: '人马大饭堂',\r\n      //     code: 'No12312312',\r\n      //     time: '2017-03-26 17:26',\r\n      //     money: '238'\r\n      //   }\r\n      // ],\r\n      // finish: [\r\n      //   {\r\n      //     img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\r\n      //     name: '人马大饭堂',\r\n      //     code: 'No12312312',\r\n      //     time: '2017-03-26 17:26',\r\n      //     money: '238',\r\n      //     delMoney: '23',\r\n      //     actMoney: '215',\r\n      //     restaurantId: 'No123123',\r\n      //     waiterId: 'waiter123123'\r\n      //   }\r\n      // ],\r\n      // cancel: [\r\n      //   {\r\n      //     img: 'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',\r\n      //     name: '人马大饭堂',\r\n      //     code: 'No12312312',\r\n      //     time: '2017-03-26 17:26',\r\n      //     money: '238'\r\n      //   }\r\n      // ]\r\n    },\r\n    shopArray: ['请选择经营品类', '湘菜', '川菜', '粤菜', '沙县小吃', '徽菜', '茶点'],\r\n    index: '0',\r\n    showMessage: null\r\n  },\r\n  /**\r\n   * 输入店名保存\r\n   * @param e\r\n   */\r\n  shopNameInput (e) {\r\n    this.setData({\r\n      shopName: e.detail.value\r\n    })\r\n  },\r\n  /**\r\n   * 选择消息显示\r\n   */\r\n  chooseMessage (e) {\r\n    this.setData({\r\n      showMessage: e.currentTarget.dataset.message\r\n    })\r\n  },\r\n  /**\r\n   * 设置couponTab\r\n   * @param e\r\n   */\r\n  chooseCouponTab (e) {\r\n    this.setData({\r\n      currentCouponTab: e.currentTarget.dataset.tabid\r\n    })\r\n  },\r\n  /**\r\n   * 去支付\r\n   * @param e\r\n   */\r\n  goPay (e) {\r\n    wx.navigateTo({\r\n      url: '../payorder/payorder?o_id=' + e.currentTarget.dataset.id + '&s_id=' + e.currentTarget.dataset.shop\r\n    })\r\n  },\r\n  /**\r\n   * 去打分或者打赏\r\n   * @param e\r\n   */\r\n  goGratuity (e) {\r\n    // todo 释放\r\n    let sid = e.currentTarget.dataset.restaurantid\r\n    let oid = e.currentTarget.dataset.oid\r\n    // let waiterId = e.currentTarget.dataset.waiterid\r\n    // let kind = e.currentTarget.dataset.kind\r\n    // let url = ''\r\n    // if (kind === 'shop') {\r\n      // url = '../grade/grade?restaurantId=' + restaurantId\r\n    let url = '../grade/grade?s_id=' + sid + '&o_id=' + oid\r\n    // } else {\r\n    //   url = '../gratuity/gratuity?waiterId=' + waiterId\r\n    // }\r\n    wx.navigateTo({\r\n      url: url\r\n    })\r\n  },\r\n  /**\r\n   * 选择经营品类\r\n   */\r\n  chooseShopKind (e) {\r\n    this.setData({\r\n      index: e.detail.value\r\n    })\r\n  },\r\n  /**\r\n   * 开始上传商家入驻相关信息\r\n   */\r\n  startShop () {\r\n    // todo 入驻信息添加到缓存中\r\n    if (!this.data.shopName || this.data.index === '0') {\r\n      return wx.showModal({\r\n        title: '信息不完整',\r\n        content: '请补充信息完整',\r\n        showCancel: false\r\n      })\r\n    }\r\n    let newShopInfo = {}\r\n    newShopInfo.shopName = this.data.shopName\r\n    newShopInfo.shopKind = this.data.shopArray[this.data.index]\r\n    wx.setStorageSync('newShopInfo', newShopInfo)\r\n    wx.redirectTo({\r\n      url: '../businessCooperation/businessCooperation?shopName=' + this.data.shopName + '&shopKind=' + this.data.shopArray[this.data.index]\r\n    })\r\n  },\r\n  // 获取用户的订单\r\n  getOrder () {\r\n    let that = this\r\n    let obj = {\r\n      url: useUrl.serviceUrl.order,\r\n      data: {\r\n        session_key: wx.getStorageSync('session_key')\r\n      },\r\n      success (res) {\r\n        if (!res.data.data.order_suoyou) return\r\n        // console.log(res)\r\n        let data = res.data.data\r\n        let orderList = {}\r\n        orderList.pay = data.order_weifu || []\r\n        let finish = []\r\n        let cancel = []\r\n        for (var item of data.order_suoyou) {\r\n          if (item.status === '2' || item.status === '3' || item.status === '4') {\r\n            finish.push(item)\r\n          }\r\n          if (item.status === '8' || item.status === '9') {\r\n            cancel.push(item)\r\n          }\r\n        }\r\n        orderList.finish = finish\r\n        orderList.cancel = cancel\r\n        that.setData({\r\n          orderList: orderList\r\n        })\r\n      }\r\n    }\r\n    app.requestInfo(obj)\r\n  },\r\n  /**\r\n   * 获取用户的排单信息\r\n   */\r\n  getWaitInfo () {\r\n    // let obj = {\r\n    //   url: useUrl.serviceUrl.queue,\r\n    //   data: {\r\n    //     session_key: wx.getStorageSync('session_key'),\r\n    //   }\r\n    // }\r\n  },\r\n  /**\r\n   * 获取用户的优惠券\r\n   */\r\n  getCoupons () {\r\n    let that = this\r\n    let obj = {\r\n      url: useUrl.serviceUrl.coupons_num,\r\n      data: {\r\n        session_key: wx.getStorageSync('session_key')\r\n      },\r\n      success (res) {\r\n        // console.log(res)\r\n        that.setData({\r\n          couponsCount: res.data.data.count,\r\n          couponNoUseList: res.data.data.status_a,\r\n          couponUseList: res.data.data.status_b,\r\n          couponOutList: res.data.data.status_c\r\n        })\r\n      }\r\n    }\r\n    app.requestInfo(obj)\r\n  },\r\n  /**\r\n   * 获取消息\r\n   */\r\n  getMation () {\r\n    let that = this\r\n    let obj = {\r\n      url: useUrl.serviceUrl.mation,\r\n      data: {\r\n        session_key: wx.getStorageSync('session_key')\r\n      },\r\n      success (res) {\r\n        // console.log(res)\r\n        let message = res.data.data\r\n        that.setData({\r\n          message: message\r\n        })\r\n        let messageArr = []\r\n        for (var item of message) {\r\n          // console.log(item)\r\n          messageArr.push(item.content)\r\n        }\r\n        console.log(messageArr)\r\n        for (let i = 0; i < messageArr.length; i++) {\r\n          WxParse.wxParse('message' + i, 'html', messageArr[i], that)\r\n          if (i === messageArr.length - 1) {\r\n            WxParse.wxParseTemArray('messageTemArr', 'message', messageArr.length, that)\r\n          }\r\n        }\r\n      }\r\n    }\r\n    app.requestInfo(obj)\r\n  },\r\n  /**\r\n   * 从消息去到对应的商店\r\n   */\r\n  goshop (e) {\r\n    console.log(e)\r\n    wx.redirectTo({\r\n      url: '../ordering/ordering?s_id=' + e.currentTarget.dataset.id\r\n    })\r\n  },\r\n  /**\r\n   * 获取用户的全部排单号\r\n   */\r\n  getpaidui () {\r\n    let that = this\r\n    let userSite = wx.getStorageSync('userSite')\r\n    let obj = {\r\n      url: useUrl.serviceUrl.queue_num,\r\n      data: {\r\n        session_key: wx.getStorageSync('session_key'),\r\n        latitude: userSite.latitude,\r\n        longitude: userSite.longitude\r\n      },\r\n      success (res) {\r\n        if (!res.data.data) return\r\n        that.setData({\r\n          numberList: res.data.data\r\n        })\r\n      }\r\n    }\r\n    app.requestInfo(obj)\r\n  },\r\n  /**\r\n   * 获取所有的优惠券信息\r\n   */\r\n  getAllCoupons () {\r\n    let that = this\r\n    let obj = {\r\n      url: useUrl.serviceUrl.getCouDetail,\r\n      data: {\r\n        session_key: wx.getStorageSync('session_key')\r\n      },\r\n      success (res) {\r\n        if (!res.data.data) return\r\n        that.setData({\r\n          integral: res.data.data\r\n        })\r\n      }\r\n    }\r\n    app.requestInfo(obj)\r\n  },\r\n  /**\r\n   * 兑换优惠券\r\n   */\r\n  getCoupon (e) {\r\n    // console.log(e)\r\n    let obj = {\r\n      url: useUrl.serviceUrl.cou_convert,\r\n      data: {\r\n        session_key: wx.getStorageSync('session_key'),\r\n        shop_id: e.currentTarget.dataset.shop,\r\n        cou_id: e.currentTarget.dataset.integralid\r\n      },\r\n      success (res) {\r\n        // console.log(res)\r\n        wx.showModal({\r\n          title: '领取优惠券',\r\n          content: res.data.data,\r\n          showCancel: false\r\n        })\r\n      }\r\n    }\r\n    app.requestInfo(obj)\r\n  },\r\n  /**\r\n   * 生命周期函数--监听页面加载\r\n   */\r\n  onLoad (params) {\r\n    // 由跳转链接设置标题\r\n    let operation = params.operation\r\n    // 设置operation\r\n    this.setData({\r\n      operation: params.operation\r\n    })\r\n    // 判断用户申请的店铺状态\r\n    if (params.shopStatus === '2' || params.shopStatus === '1') {\r\n      return wx.redirectTo({\r\n        url: '../businessCooperation/businessCooperation?shopStatus=' + params.shopStatus\r\n      })\r\n    }\r\n    // 判断传入类型\r\n    if (operation === 'number') {\r\n      operation = '我的排单号'\r\n      this.getpaidui()\r\n    } else if (operation === 'message') {\r\n      operation = '消息'\r\n      this.getMation()\r\n    } else if (operation === 'integral') {\r\n      operation = '积分兑换'\r\n      this.getAllCoupons()\r\n    } else if (operation === 'order') {\r\n      operation = '我的订单'\r\n      this.getOrder()\r\n    } else if (operation === 'merchant') {\r\n      operation = '商家入驻'\r\n    } else {\r\n      operation = '优惠券'\r\n      this.getCoupons()\r\n    }\r\n    // 设置导航栏标题\r\n    wx.setNavigationBarTitle({\r\n      title: operation\r\n    })\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面初次渲染完成\r\n   */\r\n  onReady () {\r\n    // TODO: onReady\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面显示\r\n   */\r\n  onShow () {\r\n    // TODO: onShow\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面隐藏\r\n   */\r\n  onHide () {\r\n    // TODO: onHide\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面卸载\r\n   */\r\n  onUnload () {\r\n    // TODO: onUnload\r\n  },\r\n\r\n  /**\r\n   * 页面相关事件处理函数--监听用户下拉动作\r\n   */\r\n  onPullDownRefresh () {\r\n    // TODO: onPullDownRefresh\r\n  }\r\n})\r\n"]}