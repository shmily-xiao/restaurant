{"version":3,"sources":["pages/user/user.js"],"names":["app","getApp","useUrl","require","Page","data","title","userInfo","userDetail","number","userList","icon","id","user","shopStatus","getCoupon","that","obj","url","serviceUrl","coupons_num","session_key","wx","getStorageSync","success","res","count","setData","requestInfo","getjifen","jifen","method","header","score","getpaidui","userSite","queue_num","latitude","longitude","length","onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh"],"mappings":";;AAAA;AACA,IAAMA,MAAMC,QAAZ;AACA,IAAMC,SAASC,QAAQ,qBAAR,CAAf;AACA;AACAC,KAAK;AACH;;;AAGAC,QAAM;AACJC,WAAO,MADH;AAEJC,cAAU,IAFN;AAGJC,gBAAY,CACV;AACEF,aAAO,MADT;AAEEG,cAAQ;AAFV,KADU,EAKV;AACEH,aAAO,KADT;AAEEG,cAAQ;AAFV,KALU,EASV;AACEH,aAAO,IADT;AAEEG,cAAQ;AAFV,KATU,CAHR;AAiBJC,cAAU,CACR;AACEC,YAAM,sBADR;AAEEL,aAAO,OAFT;AAGEM,UAAI;AAHN,KADQ,EAMR;AACED,YAAM,wBADR;AAEEL,aAAO,IAFT;AAGEM,UAAI;AAHN,KANQ,EAWR;AACED,YAAM,sBADR;AAEEL,aAAO,MAFT;AAGEM,UAAI;AAHN,KAXQ,EAgBR;AACED,YAAM,uBADR;AAEEL,aAAO,MAFT;AAGEM,UAAI;AAHN,KAhBQ,EAqBR;AACED,YAAM,kCADR;AAEEL,aAAO,MAFT;AAGEM,UAAI;AAHN,KArBQ,CAjBN;AA4CJC,UAAM;AACJC,kBAAY;AADR;AA5CF,GAJH;AAoDH;;;AAGAC,WAvDG,uBAuDU;AACX,QAAIC,OAAO,IAAX;;AAEA,QAAIC,MAAM;AACRC,WAAKhB,OAAOiB,UAAP,CAAkBC,WADf;AAERf,YAAM;AACJgB,qBAAaC,GAAGC,cAAH,CAAkB,aAAlB;AADT,OAFE;AAKRC,aALQ,mBAKCC,GALD,EAKM;AACZ;AACAT,aAAKX,IAAL,CAAUG,UAAV,CAAqB,CAArB,EAAwBC,MAAxB,GAAiCgB,IAAIpB,IAAJ,CAASA,IAAT,CAAcqB,KAAd,CAAoB,CAApB,CAAjC;AACAV,aAAKW,OAAL,CAAa;AACX;AACAnB,sBAAYQ,KAAKX,IAAL,CAAUG;AAFX,SAAb;AAID;AAZO,KAAV;AAcAR,QAAI4B,WAAJ,CAAgBX,GAAhB;AACD,GAzEE;;AA0EH;;;AAGAY,UA7EG,sBA6ES;AACV,QAAIb,OAAO,IAAX;AACA,QAAIC,MAAM;AACRC,WAAKhB,OAAOiB,UAAP,CAAkBW,KADf;AAERC,cAAQ,KAFA;AAGRC,cAAQ;AACN,wBAAgB;AADV,OAHA;AAMR3B,YAAM;AACJgB,qBAAaC,GAAGC,cAAH,CAAkB,aAAlB;AADT,OANE;AASRC,aATQ,mBASCC,GATD,EASM;AACZ,YAAI,CAACA,IAAIpB,IAAJ,CAASA,IAAd,EAAoB;AACpB,YAAIG,aAAaQ,KAAKX,IAAL,CAAUG,UAA3B;AACAA,mBAAW,CAAX,EAAcC,MAAd,GAAuBgB,IAAIpB,IAAJ,CAASA,IAAT,CAAc4B,KAArC;AACAjB,aAAKW,OAAL,CAAa;AACXnB,sBAAYA;AADD,SAAb;AAGD;AAhBO,KAAV;AAkBAR,QAAI4B,WAAJ,CAAgBX,GAAhB;AACD,GAlGE;;AAmGH;;;AAGAiB,WAtGG,uBAsGU;AACX,QAAIlB,OAAO,IAAX;AACA,QAAImB,WAAWb,GAAGC,cAAH,CAAkB,UAAlB,CAAf;AACA,QAAIN,MAAM;AACRC,WAAKhB,OAAOiB,UAAP,CAAkBiB,SADf;AAER/B,YAAM;AACJgB,qBAAaC,GAAGC,cAAH,CAAkB,aAAlB,CADT;AAEJc,kBAAUF,SAASE,QAFf;AAGJC,mBAAWH,SAASG;AAHhB,OAFE;AAORd,aAPQ,mBAOCC,GAPD,EAOM;AACZ,YAAI,CAACA,IAAIpB,IAAJ,CAASA,IAAd,EAAoB;AACpB,YAAIG,aAAaQ,KAAKX,IAAL,CAAUG,UAA3B;AACAA,mBAAW,CAAX,EAAcC,MAAd,GAAuBgB,IAAIpB,IAAJ,CAASA,IAAT,CAAckC,MAArC;AACAvB,aAAKW,OAAL,CAAa;AACXnB,sBAAYA;AADD,SAAb;AAGD;AAdO,KAAV;AAgBAR,QAAI4B,WAAJ,CAAgBX,GAAhB;AACD,GA1HE;;AA2HH;;;AAGAuB,QA9HG,oBA8HO;AACR,SAAKb,OAAL,CAAa;AACXpB,gBAAUe,GAAGC,cAAH,CAAkB,UAAlB;AADC,KAAb;AAGA;AACD,GAnIE;;;AAqIH;;;AAGAkB,SAxIG,qBAwIQ;AACT;AACD,GA1IE;;;AA4IH;;;AAGAC,QA/IG,oBA+IO;AACR,SAAK3B,SAAL;AACA,SAAKc,QAAL;AACA,SAAKK,SAAL;AACA;AACD,GApJE;;;AAsJH;;;AAGAS,QAzJG,oBAyJO;AACR;AACD,GA3JE;;;AA6JH;;;AAGAC,UAhKG,sBAgKS;AACV;AACD,GAlKE;;;AAoKH;;;AAGAC,mBAvKG,+BAuKkB;AACnB;AACD;AAzKE,CAAL","file":"user.js","sourcesContent":["// 获取全局应用程序实例对象\r\nconst app = getApp()\r\nconst useUrl = require('../../utils/service')\r\n// 创建页面实例对象\r\nPage({\r\n  /**\r\n   * 页面的初始数据\r\n   */\r\n  data: {\r\n    title: 'user',\r\n    userInfo: null,\r\n    userDetail: [\r\n      {\r\n        title: '正在排队',\r\n        number: 0\r\n      },\r\n      {\r\n        title: '优惠券',\r\n        number: 4\r\n      },\r\n      {\r\n        title: '积分',\r\n        number: 0\r\n      }\r\n    ],\r\n    userList: [\r\n      {\r\n        icon: 'iconfont icon-xiaoxi',\r\n        title: '我的排单号',\r\n        id: 'number'\r\n      },\r\n      {\r\n        icon: 'iconfont icon-lingdang',\r\n        title: '消息',\r\n        id: 'message'\r\n      },\r\n      {\r\n        icon: 'iconfont icon-fapiao',\r\n        title: '积分兑换',\r\n        id: 'integral'\r\n      },\r\n      {\r\n        icon: 'iconfont icon-dingdan',\r\n        title: '我的订单',\r\n        id: 'order'\r\n      },\r\n      {\r\n        icon: 'iconfont icon-iconfontruzhu-copy',\r\n        title: '商家入驻',\r\n        id: 'merchant'\r\n      }\r\n    ],\r\n    user: {\r\n      shopStatus: 0\r\n    }\r\n  },\r\n  /**\r\n   * 优惠券\r\n   */\r\n  getCoupon () {\r\n    let that = this\r\n\r\n    let obj = {\r\n      url: useUrl.serviceUrl.coupons_num,\r\n      data: {\r\n        session_key: wx.getStorageSync('session_key')\r\n      },\r\n      success (res) {\r\n        // console.log(res)\r\n        that.data.userDetail[1].number = res.data.data.count[0]\r\n        that.setData({\r\n          // couponsCount: res.data.data.count,\r\n          userDetail: that.data.userDetail\r\n        })\r\n      }\r\n    }\r\n    app.requestInfo(obj)\r\n  },\r\n  /**\r\n   * 获取用户积分信息\r\n   */\r\n  getjifen () {\r\n    let that = this\r\n    let obj = {\r\n      url: useUrl.serviceUrl.jifen,\r\n      method: 'GET',\r\n      header: {\r\n        'content-type': 'application/json'\r\n      },\r\n      data: {\r\n        session_key: wx.getStorageSync('session_key')\r\n      },\r\n      success (res) {\r\n        if (!res.data.data) return\r\n        let userDetail = that.data.userDetail\r\n        userDetail[2].number = res.data.data.score\r\n        that.setData({\r\n          userDetail: userDetail\r\n        })\r\n      }\r\n    }\r\n    app.requestInfo(obj)\r\n  },\r\n  /**\r\n   * 获取用户的全部排队号\r\n   */\r\n  getpaidui () {\r\n    let that = this\r\n    let userSite = wx.getStorageSync('userSite')\r\n    let obj = {\r\n      url: useUrl.serviceUrl.queue_num,\r\n      data: {\r\n        session_key: wx.getStorageSync('session_key'),\r\n        latitude: userSite.latitude,\r\n        longitude: userSite.longitude\r\n      },\r\n      success (res) {\r\n        if (!res.data.data) return\r\n        let userDetail = that.data.userDetail\r\n        userDetail[0].number = res.data.data.length\r\n        that.setData({\r\n          userDetail: userDetail\r\n        })\r\n      }\r\n    }\r\n    app.requestInfo(obj)\r\n  },\r\n  /**\r\n   * 生命周期函数--监听页面加载\r\n   */\r\n  onLoad () {\r\n    this.setData({\r\n      userInfo: wx.getStorageSync('userInfo')\r\n    })\r\n    // TODO: onLoad\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面初次渲染完成\r\n   */\r\n  onReady () {\r\n    // TODO: onReady\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面显示\r\n   */\r\n  onShow () {\r\n    this.getCoupon()\r\n    this.getjifen()\r\n    this.getpaidui()\r\n    // TODO: onShow\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面隐藏\r\n   */\r\n  onHide () {\r\n    // TODO: onHide\r\n  },\r\n\r\n  /**\r\n   * 生命周期函数--监听页面卸载\r\n   */\r\n  onUnload () {\r\n    // TODO: onUnload\r\n  },\r\n\r\n  /**\r\n   * 页面相关事件处理函数--监听用户下拉动作\r\n   */\r\n  onPullDownRefresh () {\r\n    // TODO: onPullDownRefresh\r\n  }\r\n})\r\n"]}